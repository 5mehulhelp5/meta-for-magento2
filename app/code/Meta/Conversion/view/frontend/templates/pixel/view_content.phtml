<?php
/* @var \Meta\Conversion\Block\Pixel\ViewContent $block */

$trackerUrl = $block->getTrackerUrl();
?>

<!-- Added the new component below to track server events -->
<script type="text/x-magento-init">
    {
        "*": {
            "Meta_Conversion/js/metaPixelTracker" : {
                "url" : "<?= $block->escapeJs($trackerUrl); ?>",
                "payload": <?= json_encode([
                    "eventName" => $block->getEventToObserveName(),
                    "productId" => $block->getProductId()
                ]) ?>,
                "browserEventData": <?= json_encode([
                    'fbAgentVersion' => $block->getFacebookAgentVersion(),
                    'fbPixelId' => $block->getFacebookPixelID(),
                    'source' => $block->getSource(),
                    'pluginVersion' => $block->getPluginVersion(),
                    'track' => 'trackCustom',
                    'event' => 'ViewContent'
                ]) ?>
            }
        }
    }
</script>
